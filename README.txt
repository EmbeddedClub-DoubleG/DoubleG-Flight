本源码包由 红蚂蚁实验室 发布。由四轴组成员 编写 ，用于captain飞控板。
用于实现悬停、寻迹、避障功能。

支持上位机为AHRS_Captain_Flight上位机 以及 由营长编写的labview上位机。在编译前需在fly_config.h文件中配置要使用的上位机。

-------------------------------------------------------------------------------------------------

这是一个说明文档，用于解释飞控程序各种模块大致功能。

程序文件说明：
	路径   			      文件功能
\HardWareDriver 	  传感器和各种硬件的驱动程序，每个驱动由一个.C文件和一个.H文件组成。
					  .C源文件的开头部分，会有该驱动的基本说明，和连线方式
					  .H头文件 引出了该驱动向外部提供的接口程序，例如初始化，读取参数，或者是供外部程序调用的变量

\HardWareDriver\ADC   STM32内部的ADC驱动，用于读取飞控板上的舵机电压和外部电池电压。

\HardWareDriver\AT45DB	 飞控板上的Flash芯片的驱动程序，通过SPI2连接AT45DB。提供了读写数据的接口
						 AT45DB用于存放 关键的配置参数。如PID参数，PWM偏置，磁标定的数据等等

\HardWareDriver\GCS_Protocol   与上位机软件的通信协议，包含发送目标信息，发送系统状态，发送位置信息等协议

\HardWareDriver\GPS     GPS模块的驱动，用于接收GPS数据，并解出位置‘时间’高度等信息。GPS模块需要连接到USART3
						GPS的波特率要与USART3的波特率对应，并且要能输出NEMA0183语句，
						$GPGGA   和   $GPRMC   语句

\HardWareDriver\IMU     姿态解算的程序，

\HardWareDriver\LED     飞控板上的LED 驱动程序。建议使用 LED_Set_Blink 子程序设置LED的闪烁

\HardWareDriver\Math     数学运算相关的子程序。

\HardWareDriver\MPU6500  MPU6500的驱动程序，提供初始化和读取加速度和陀螺仪数据

\HardWareDriver\MS5611   气压高度计MS5611的驱动程序。初始化和读取气压值，并转换成高度。

\HardWareDriver\PWM_Input  PWM输入，只需调用一次初始化后，所有的通道都在中断里完成采集

\HardWareDriver\PWM_Output  PWM输出，用户可以在.H头文件中，配置各通道的PWM的频率。

\HardWareDriver\Quadrotor   四轴控制程序，PID控制环，手动和自动的切换，等等关于四轴的飞行控制

\HardWareDriver\Service    底层的服务程序，提供精确定时，提供整个系统的时间us级，同时软件I2C的驱动

\HardWareDriver\UART1    串口驱动程序，USART1用于连接电脑，发送遥测数据。并接收上位机软件的命令

\HardWareDriver\Ultrasonic  超声波模块的驱动程序。

-------------------------------------
\Config目录下 有两个关键的头文件。它们分别是：
datamap.h    AT45DB内部关键数据的存储结构 

fly_config.h  目标飞行器的一些关键参数配置，如机型选择，航向反向 

-----------------------------------------------------------------------------------------------
飞行注意事项：
在起飞前，请先确认是否进行过以下的操作：
1. 在四轴平放并且静止下，采集陀螺仪的零偏和重力加速度
2. 至少做过一次磁标定 
3. 选择的飞行模式是否和飞行器对应，[默认是十字模式的四轴]
4. 飞行航向控制。是否需要反向。测试方法见前述。
	3）手转动四轴（绕着Z轴），看在YAW角度上是否有一个反馈力，阻碍转动。





注意，飞控中关于THROTTLE_LOCKed功能的代码只适用于十字型四轴和x型四轴。如果要用于其他多轴飞行棋，在pwmoutput.c文件完善相应代码。


